<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Grabbit Options</title>
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/components/sidebar.css">
    <link rel="stylesheet" href="/css/options.css">
    <link rel="stylesheet" href="/css/components/footer.css">
</head>

<body>
    <div id="sidebar-placeholder"></div>
    <div class="container">
        <div id="main-options">
            <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin-bottom: 2rem;">
                <img src="icons/icon128.png" alt="Grabbit Logo" style="width: 64px; height: 64px;">
                <h1 style="margin: 0;">Grabbit Settings</h1>
            </div>

            <div class="card rate-card">
                <div class="rate-content">
                    <h3>Enjoying Grabbit?</h3>
                    <p>Your 5-star rating helps others discover this extension!</p>
                    <button id="rateExtensionButton" class="rate-extension-button">
                        <span class="star-icons">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
                        Rate on Chrome Web Store
                    </button>
                </div>
            </div>




            <div class="card instructions-container">
                <div class="instructions-split">
                    <div class="instructions-panel">
                        <h2>How to Use Grabbit</h2>
                        <ul class="instructions-list">
                            <li>Click the "Add New Action" button</li>
                            <li>Configure your activation keys</li>
                            <li>Choose a color for your action</li>
                            <li>Determine the action to perform</li>
                            <li>Toggle smart select on or off</li>
                            <li>Press "Save" to apply changes</li>
                            <li>Use activation keys and mouse to start selecting links</li>
                        </ul>
                    </div>

                    <div class="instructions-panel">
                        <h2>How to Use Grabbit Popup</h2>
                        <ul class="instructions-list">
                            <li>
                                <button id="pinExtensionButton" class="pin-button">
                                    Pin Extension to Toolbar
                                </button>
                            </li>
                            <li>Select Multiple Tabs (Ctrl or Shift + Click)</li>
                            <li>Click extension icon to open popup</li>
                            <li>Use "Copy Selected Tab URLs" to copy links</li>
                            <li>Use "Open Copied Links" to open copied URLs in new tabs</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="savedActions">
                <!-- Saved actions will be displayed here -->
            </div>

            <div class="card">
                <button class="action-button">
                    Add New Action
                </button>
            </div>
        </div>

        <div id="footer-placeholder"></div>
    </div>

    <!-- Modal -->
    <div class="modal" id="actionModal">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <h2 id="modalTitle">Create New Action</h2>
                <button class="modal-close">&times;</button>
            </div>

            <!-- Modal Body - Scrollable -->
            <div class="modal-body">
                <!-- Activation Section -->
                <div class="modal-section">
                    <div class="section-header">
                        <span class="section-icon">&#9889;</span>
                        <h3>Activation</h3>
                        <span class="section-badge required-badge">Required</span>
                    </div>
                    <p class="section-description">Configure how to trigger this action</p>

                    <div class="two-column-grid">
                        <div class="input-group compact">
                            <label>Mouse button</label>
                            <select class="key-select required" id="mouseButton" required>
                                <option value="">Select...</option>
                                <option value="left">Left Click</option>
                                <option value="right">Right Click</option>
                                <option value="middle">Middle Click</option>
                            </select>
                        </div>
                        <div class="input-group compact">
                            <label>+ Modifier Key</label>
                            <select class="key-select" id="combinedKey">
                                <option value="none">None</option>
                                <optgroup label="Modifier Keys">
                                    <option value="ctrl">Ctrl</option>
                                    <option value="shift">Shift</option>
                                    <option value="alt">Alt</option>
                                </optgroup>
                                <optgroup label="Letter Keys">
                                    <option value="a">A</option>
                                    <option value="b">B</option>
                                    <option value="c">C</option>
                                    <option value="d">D</option>
                                    <option value="e">E</option>
                                    <option value="f">F</option>
                                    <option value="g">G</option>
                                    <option value="h">H</option>
                                    <option value="i">I</option>
                                    <option value="j">J</option>
                                    <option value="k">K</option>
                                    <option value="l">L</option>
                                    <option value="m">M</option>
                                    <option value="n">N</option>
                                    <option value="o">O</option>
                                    <option value="p">P</option>
                                    <option value="q">Q</option>
                                    <option value="r">R</option>
                                    <option value="s">S</option>
                                    <option value="t">T</option>
                                    <option value="u">U</option>
                                    <option value="v">V</option>
                                    <option value="w">W</option>
                                    <option value="x">X</option>
                                    <option value="y">Y</option>
                                    <option value="z">Z</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="input-group compact">
                            <label>Box color</label>
                            <input type="color" class="color-picker" id="boxColor" value="#2196F3">
                        </div>
                        <div class="input-group compact">
                            <label>Border</label>
                            <div class="inline-inputs">
                                <input type="number" class="key-select small-input" id="borderThickness" min="1"
                                    max="10" value="2" title="Thickness (px)">
                                <select class="key-select" id="borderStyle">
                                    <option value="solid">Solid</option>
                                    <option value="dashed">Dashed</option>
                                    <option value="dotted">Dotted</option>
                                    <option value="double">Double</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="error-message" id="mouseButtonError">Please select a mouse button</div>
                    <div class="error-message" id="combinationError">This key and mouse combination is already in use!
                    </div>
                    <div class="warning-message" id="letterKeyWarning">
                        <span class="warning-icon">⚠️</span> Letter keys may not work correctly with laptop trackpads.
                        Consider using Ctrl, Shift, or Alt instead.
                    </div>
                </div>

                <!-- Action Section -->
                <div class="modal-section">
                    <div class="section-header">
                        <span class="section-icon">&#127919;</span>
                        <h3>Action</h3>
                        <span class="section-badge required-badge">Required</span>
                    </div>
                    <div class="input-group">
                        <label>This action should...</label>
                        <select class="key-select required" id="actionType" required>
                            <option value="">Select Action Type</option>
                            <option value="openLinks">Open links in new tabs</option>
                            <option value="openWindow">Open links in a new window</option>
                            <option value="copyUrls">Copy URLs to clipboard</option>
                            <option value="copyUrlsAndTitles">Copy URLs with page titles</option>
                            <option value="copyTitles">Copy page titles only</option>
                            <option value="createBookmarks">Create Bookmarks</option>
                        </select>
                    </div>
                    <div class="error-message" id="actionTypeError">Please select an action type</div>
                </div>

                <!-- Format Options Section (conditionally shown) -->
                <div class="modal-section" id="formatOptionsContainer" style="display: none;">
                    <div class="section-header">
                        <span class="section-icon">&#128221;</span>
                        <h3>Format Options</h3>
                        <span class="section-badge optional-badge">Optional</span>
                    </div>
                    <p class="section-description">Customize how URLs and titles are formatted</p>

                    <div class="two-column-grid">
                        <div class="input-group compact">
                            <label>Format pattern</label>
                            <select class="key-select" id="formatPattern">
                                <option value="titleFirst">Title → URL</option>
                                <option value="urlFirst">URL → Title</option>
                                <option value="markdown">Markdown [Title](URL)</option>
                                <option value="json">JSON [{"title":"...","url":"..."}]</option>
                            </select>
                        </div>
                        <div class="input-group compact">
                            <label>Separator type</label>
                            <select class="key-select" id="separatorType">
                                <option value="newline">New line</option>
                                <option value="space">Space</option>
                                <option value="tab">Tab (Excel)</option>
                                <option value="comma">Comma (,)</option>
                                <option value="dot">Dot (.)</option>
                            </select>
                        </div>
                        <div class="input-group compact">
                            <label>Separator count</label>
                            <input type="number" id="separatorCount" class="key-select" min="1" max="10" value="1">
                        </div>
                        <div class="input-group compact">
                            <label>Lines between links</label>
                            <input type="number" id="linkSeparatorCount" class="key-select" min="0" max="10" value="0">
                        </div>
                    </div>

                    <!-- Format Preview -->
                    <div class="format-preview-container">
                        <label class="preview-label">Preview</label>
                        <div class="format-preview" id="formatPreview">
                            <!-- Preview will be generated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Advanced Options Section - Collapsible -->
                <div class="modal-section collapsible-section">
                    <div class="collapsible-header" id="advancedOptionsToggle">
                        <div class="section-header">
                            <span class="section-icon">&#9881;</span>
                            <h3>Advanced Options</h3>
                            <span class="section-badge optional-badge">Optional</span>
                        </div>
                        <span class="collapse-icon">&#9660;</span>
                    </div>
                    <div class="collapsible-content" id="advancedOptionsContent">
                        <div class="advanced-grid">
                            <div class="advanced-option-row">
                                <div class="option-info">
                                    <label>Smart select (heading filter)</label>
                                    <div class="smart-select-info">
                                        <div class="tooltip">When enabled, if your selection touches a main title or
                                            heading link, only similar important links will be selected — ignoring
                                            navigation menus, footers, and other clutter.</div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="smartSelect">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="advanced-option-row">
                                <div class="option-info">
                                    <label>Avoid duplicates</label>
                                    <div class="smart-select-info">
                                        <div class="tooltip">Removes duplicate URLs when selecting multiple links.</div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="avoidDuplicates" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="advanced-option-row">
                                <div class="option-info">
                                    <label>Reverse order</label>
                                    <div class="smart-select-info">
                                        <div class="tooltip">Open/copy links in reverse order of selection.</div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="reverseOrder">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="advanced-option-row">
                                <div class="option-info">
                                    <label>Mark links as visited</label>
                                    <div class="smart-select-info">
                                        <div class="tooltip">Visually mark processed links as visited (purple) in the browser.</div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="markVisited">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="advanced-option-row" id="openAtEndContainer">
                                <div class="option-info">
                                    <label>Open at end of tabs</label>
                                    <div class="smart-select-info">
                                        <div class="tooltip">New tabs open at the end of all tabs instead of after the
                                            current tab.</div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="openAtEnd">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="advanced-option-row" id="delayOptionContainer">
                                <div class="option-info">
                                    <label>Tab delay</label>
                                    <div class="smart-select-info">
                                        <div class="tooltip">Delay between opening each tab (seconds).</div>
                                    </div>
                                </div>
                                <div class="delay-control">
                                    <input type="range" id="tabDelay" min="0" max="30" value="0" step="0.5">
                                    <span id="delayValue">0s</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer">
                <button class="modal-button cancel-button" id="cancelButton">Cancel</button>
                <button class="modal-button save-button" id="saveButton">Save Action</button>
            </div>
        </div>
    </div>

    <script src="js/components/sidebar.js"></script>
    <script src="js/components/footer.js"></script>
    <script src="js/utils.js"></script>
    <script type="module" src="js/options/main.js"></script>

</body>

</html>